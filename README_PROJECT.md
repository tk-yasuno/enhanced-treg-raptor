# Enhanced Treg RAPTOR - Regulatory T Cell Literature Analysis with RAPTOR Tree

[![Python 3.11+](https://img.shields.io/badge/python-3.11+-blue.svg)](https://www.python.org/downloads/)
[![PyTorch 2.5+](https://img.shields.io/badge/PyTorch-2.5%2B-orange.svg)](https://pytorch.org/)
[![CUDA 12.1](https://img.shields.io/badge/CUDA-12.1-green.svg)](https://developer.nvidia.com/cuda-toolkit)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

**éšå±¤çš„RAPTORãƒ„ãƒªãƒ¼ã«ã‚ˆã‚‹åˆ¶å¾¡æ€§Tç´°èƒï¼ˆTregï¼‰æ–‡çŒ®ã®è‡ªå‹•åˆ†é¡ã¨è§£æã‚·ã‚¹ãƒ†ãƒ **

PubMedã‹ã‚‰å®Ÿéš›ã®Tregé–¢é€£æ–‡çŒ®ã‚’åé›†ã—ã€Enhanced Treg Vocabularyï¼ˆ7å±¤316ç”¨èªï¼‰ã‚’ç”¨ã„ã¦é«˜ç²¾åº¦ã«åˆ†é¡ã€‚å“è³ªè©•ä¾¡æŒ‡æ¨™ï¼ˆSilhouette + DBIï¼‰ã«åŸºã¥ãæœ€é©ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°ã§RAPTORãƒ„ãƒªãƒ¼ã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚

---

## ğŸ¯ ä¸»ãªç‰¹å¾´

### 1. å®Ÿæ–‡çŒ®ãƒ™ãƒ¼ã‚¹ã®RAPTORãƒ„ãƒªãƒ¼æ§‹ç¯‰
- **PubMedçµ±åˆ**: NCBI E-utilities APIã§æœ€æ–°æ–‡çŒ®ã‚’è‡ªå‹•åé›†
- **2,144æ–‡æ›¸**: å®Ÿéš›ã®Tregç ”ç©¶è«–æ–‡ã‹ã‚‰æ§‹ç¯‰
- **7å±¤éšå±¤åˆ†é¡**: HSC â†’ CLP â†’ CD4+T â†’ CD25+CD127low â†’ nTreg/iTreg â†’ Foxp3+ â†’ Functional
- **101å†…éƒ¨ãƒãƒ¼ãƒ‰**: åŠ¹ç‡çš„ãªéšå±¤æ§‹é€ 

### 2. é«˜åº¦ãªã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°æœ€é©åŒ–
- **ãƒãƒ©ãƒ³ã‚¹æˆ¦ç•¥**: Silhouette 0.5 + DBI 0.5
- **ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼æ•°åˆ¶é™**: k=2~5ï¼ˆå¹³å‡3.2ï¼‰
- **å“è³ªä¿è¨¼**: Silhouette 0.077ã€DBI 2.99
- **Embeddingæ¤œè¨¼**: æ¬¡å…ƒãƒ»ãƒãƒ«ãƒ ãƒ»é¡ä¼¼åº¦ã®è‡ªå‹•ãƒã‚§ãƒƒã‚¯

### 3. Level 0åã‚Šå¯¾ç­–ã®2æ®µéšã‚¢ãƒ—ãƒ­ãƒ¼ãƒ
- **åé›†æ®µéš**: Level 0ï¼ˆHSCï¼‰ã‚’200ä»¶ã«åˆ¶é™
- **åˆ¤å®šå¾Œãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°**: 500ä»¶ã«åˆ¶é™ï¼ˆãƒ©ãƒ³ãƒ€ãƒ ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ï¼‰
- **çµæœ**: Level 0æ¯”ç‡ã‚’48% â†’ 23.3%ã«å‰Šæ¸›

### 4. Enhanced Treg Vocabularyï¼ˆ316ç”¨èªï¼‰
- **7å±¤éšå±¤**: é€ è¡€å¹¹ç´°èƒã‹ã‚‰Tregæ©Ÿèƒ½ã¾ã§
- **è‡¨åºŠãƒãƒ¼ã‚«ãƒ¼å¯¾å¿œ**: CD25+CD127lowã€TSDRã€Foxp3å®‰å®šæ€§
- **æ—¥è‹±ãƒã‚¤ãƒªãƒ³ã‚¬ãƒ«**: å…¨ç”¨èªã§æ—¥æœ¬èªãƒ»è‹±èªå¯¾å¿œ

---

## ğŸ“Š ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å®Ÿç¸¾

### æœ€çµ‚ç‰ˆï¼ˆv3.0.0ï¼‰ã®çµæœ

```
ç·æ–‡æ›¸æ•°: 2,144
å†…éƒ¨ãƒãƒ¼ãƒ‰: 101 (-62% from baseline)
ãƒ„ãƒªãƒ¼æ·±ã•: 3
å¹³å‡ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼æ•°: 3.2 (-47% from baseline)
æ§‹ç¯‰æ™‚é–“: 35.6ç§’

ãƒ¬ãƒ™ãƒ«åˆ†å¸ƒ:
  Level 0 (HSC):              500 docs (23.3%) âœ…
  Level 1 (CLP):               50 docs ( 2.3%)
  Level 2 (CD4+T):            151 docs ( 7.0%)
  Level 3 (CD25+CD127low):     15 docs ( 0.7%)
  Level 4 (nTreg/iTreg):      921 docs (43.0%)
  Level 5 (Foxp3+):           420 docs (19.6%)
  Level 6 (Functional):        87 docs ( 4.1%)

ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°å“è³ª:
  Silhouette: 0.077 (range: -1~1, higher is better)
  DBI: 2.99 (range: 0~âˆ, lower is better)
  
Embeddingå“è³ª:
  æ¬¡å…ƒæ•°: 384
  å¹³å‡ãƒãƒ«ãƒ : 7.300 Â± 0.273
  ã‚µãƒ³ãƒ—ãƒ«é–“é¡ä¼¼åº¦: 0.740 Â± 0.066
```

### æ”¹å–„ã®è»Œè·¡

| ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | Level 0 | å¹³å‡k | å†…éƒ¨ãƒãƒ¼ãƒ‰ | Silhouette |
|-----------|---------|-------|------------|------------|
| v1.0 (Baseline) | 48.0% | 6.1 | 268 | 0.073 |
| v2.0 (æœ€é©åŒ–) | 41.6% | 3.7 | 129 | 0.072 |
| **v3.0 (æœ€çµ‚ç‰ˆ)** | **23.3%** | **3.2** | **101** | **0.077** |
| **æ”¹å–„ç‡** | **-51%** | **-47%** | **-62%** | **+5%** |

---

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### å¿…è¦è¦ä»¶

- Python 3.11+
- CUDA 12.1+ (GPUæ¨è«–ç”¨)
- 16GB+ GPU VRAMæ¨å¥¨

### ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
git clone https://github.com/yourusername/enhanced-treg-raptor.git
cd enhanced-treg-raptor
pip install -r requirements.txt
```

### åŸºæœ¬çš„ãªä½¿ã„æ–¹

#### 1. RAPTORãƒ„ãƒªãƒ¼æ§‹ç¯‰

```bash
python build_treg_raptor_16x.py
```

**å®Ÿè¡Œå†…å®¹**:
- PubMedã‹ã‚‰æ–‡çŒ®åé›†ï¼ˆLevel 0ã¯200ä»¶ã§åœæ­¢ï¼‰
- ãƒ¬ãƒ™ãƒ«åˆ¤å®šã¨2æ®µéšãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
- Embeddingå“è³ªæ¤œè¨¼
- RAPTORãƒ„ãƒªãƒ¼æ§‹ç¯‰ï¼ˆk=2~5ã€ãƒãƒ©ãƒ³ã‚¹æˆ¦ç•¥ï¼‰
- çµæœä¿å­˜ï¼ˆJSON + ãƒ­ã‚°ï¼‰

**å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«**:
```
results/
â”œâ”€â”€ enhanced_treg_raptor_80x_YYYYMMDD_HHMMSS.json
â”œâ”€â”€ treg_documents_80x_YYYYMMDD_HHMMSS.json
â””â”€â”€ treg_80x_build_YYYYMMDD_HHMMSS.log
```

#### 2. ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°çµ±è¨ˆã®ç¢ºèª

```bash
python check_clustering_stats.py results/enhanced_treg_raptor_80x_*.json
```

**å‡ºåŠ›ä¾‹**:
```
ğŸ“Š ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°å“è³ªçµ±è¨ˆ (Silhouette 0.5 + DBI 0.5, k=2~5)
  âœ“ å¹³å‡Silhouette: 0.077
  âœ“ å¹³å‡DBI: 2.987
  âœ“ å¹³å‡ã‚¯ãƒ©ã‚¹ã‚¿æ•°: 3.2
  âœ“ è©•ä¾¡å›æ•°: 37

ğŸŒ³ RAPTOR ãƒ„ãƒªãƒ¼æ§‹é€ 
  ç·ãƒãƒ¼ãƒ‰æ•°: 2245
  å†…éƒ¨ãƒãƒ¼ãƒ‰æ•°: 101
  Level 0: 500 docs (23.3%)
```

#### 3. ãƒ„ãƒªãƒ¼å¯è¦–åŒ–

```bash
python visualize_treg_raptor_tree.py results/enhanced_treg_raptor_80x_*.json
```

**ç”Ÿæˆã•ã‚Œã‚‹å¯è¦–åŒ–**:
- `tree_structure_*.png`: éšå±¤æ§‹é€ å›³ï¼ˆ101å†…éƒ¨ãƒãƒ¼ãƒ‰ï¼‰
- `level_distribution_*.png`: ãƒ¬ãƒ™ãƒ«åˆ¥åˆ†å¸ƒ
- `cluster_analysis_*.png`: ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°å“è³ª

---

## ğŸ“š è©³ç´°ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

å®Œå…¨ãªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ [README.md](README.md) ã‚’å‚ç…§ã—ã¦ãã ã•ã„:

- ğŸ”¬ æ”¹å–„ãƒ—ãƒ­ã‚»ã‚¹ã¨æ•™è¨“ï¼ˆ3ãƒ•ã‚§ãƒ¼ã‚ºã®è©³ç´°ï¼‰
- ğŸ’¡ 6ã¤ã®é‡è¦ãªæ•™è¨“
- ğŸ”§ å®Ÿè£…ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹
- ğŸ“– Enhanced Treg Vocabularyï¼ˆ316ç”¨èªï¼‰
- ğŸ§¬ ç”Ÿç‰©å­¦çš„èƒŒæ™¯
- ğŸ“ˆ åˆ¤å®šã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 

---

## ğŸ› ï¸ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ

```
enhanced-treg-raptor/
â”œâ”€â”€ build_treg_raptor_16x.py          # ãƒ¡ã‚¤ãƒ³ãƒ“ãƒ«ãƒ‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ true_raptor_builder.py            # RAPTORãƒ„ãƒªãƒ¼å®Ÿè£…
â”œâ”€â”€ enhanced_treg_vocab.py            # 7å±¤316ç”¨èªã®èªå½™å®šç¾©
â”œâ”€â”€ visualize_treg_raptor_tree.py     # å¯è¦–åŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ check_clustering_stats.py         # çµ±è¨ˆåˆ†æ
â”œâ”€â”€ requirements.txt                  # ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
â”œâ”€â”€ README.md                         # å®Œå…¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”œâ”€â”€ README_PROJECT.md                 # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«
â””â”€â”€ results/
    â”œâ”€â”€ enhanced_treg_raptor_80x_*.json
    â”œâ”€â”€ treg_documents_80x_*.json
    â””â”€â”€ visualizations/
        â”œâ”€â”€ tree_structure_*.png
        â”œâ”€â”€ level_distribution_*.png
        â””â”€â”€ cluster_analysis_*.png
```

---

## ğŸ’¡ é‡è¦ãªæ•™è¨“ï¼ˆè¦ç´„ï¼‰

### 1. Level 0åã‚Šã«ã¯2æ®µéšã‚¢ãƒ—ãƒ­ãƒ¼ãƒãŒå¿…é ˆ
- âŒ åé›†åˆ¶é™ã®ã¿: 400ä»¶ â†’ åˆ¤å®šå¾Œ982ä»¶ã«å¢—åŠ 
- âœ… 2æ®µéš: åé›†200ä»¶ + åˆ¤å®šå¾Œ500ä»¶ = æœ€çµ‚23.3%

### 2. ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼æ•°åˆ¶é™ã®çµ¶å¤§ãªåŠ¹æœ
- k=2~5ã«åˆ¶é™ â†’ å†…éƒ¨ãƒãƒ¼ãƒ‰-62%
- æ•°å¼: å†…éƒ¨ãƒãƒ¼ãƒ‰ â‰ˆ Î£(æ–‡æ›¸æ•° / k)

### 3. Embeddingæ¤œè¨¼ã¯å¿…é ˆ
- æ¬¡å…ƒæ•°ã€ãƒãƒ«ãƒ ã€é¡ä¼¼åº¦ã‚’è‡ªå‹•ãƒã‚§ãƒƒã‚¯
- ç•°å¸¸æ¤œçŸ¥ã§ãƒ‡ãƒãƒƒã‚°ãŒå®¹æ˜“ã«

### 4. ãƒãƒ©ãƒ³ã‚¹æˆ¦ç•¥ãŒæœ€é©
- Silhouette 0.5 + DBI 0.5
- å“è³ªå‘ä¸Šã¨ãƒãƒ¼ãƒ‰å‰Šæ¸›ã‚’ä¸¡ç«‹

---

## ğŸ”§ è¨­å®šã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

### Level 0å‰Šæ¸›ã®èª¿æ•´

```python
# build_treg_raptor_16x.py
level_0_max = 200    # PubMedåé›†ä¸Šé™
level_0_limit = 500  # åˆ¤å®šå¾Œä¸Šé™

# ã‚ˆã‚Šå¼·ãå‰Šæ¸›ã™ã‚‹å ´åˆ
level_0_max = 100
level_0_limit = 300
```

### ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°æˆ¦ç•¥ã®å¤‰æ›´

```python
# true_raptor_builder.py
self.metric_weights = {
    'silhouette': 0.5,  # ã‚¯ãƒ©ã‚¹ã‚¿å†…å‡é›†åº¦
    'dbi': 0.5,         # ã‚¯ãƒ©ã‚¹ã‚¿é–“åˆ†é›¢åº¦
}
self.max_clusters = 5  # k=2~5
```

---

## ğŸ“Š æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

- **Embedding**: sentence-transformers/all-MiniLM-L6-v2 (384æ¬¡å…ƒ)
- **ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°**: K-means + Silhouette/DBIè©•ä¾¡
- **LLMè¦ç´„**: OPT models (1.3B/2.7B/6.7B) - GPUæ¨è«–
- **æ–‡çŒ®åé›†**: PubMed E-utilities API
- **å¯è¦–åŒ–**: matplotlib + networkx

---

## ğŸ“ å¤‰æ›´å±¥æ­´

### v3.0.0 (2025-11-02) - Level 0å‰Šæ¸›ç‰ˆ âœ…
- Level 0å‰Šæ¸›: 48% â†’ 23.3% (-51%)
- å¹³å‡kå‰Šæ¸›: 6.1 â†’ 3.2 (-47%)
- å†…éƒ¨ãƒãƒ¼ãƒ‰å‰Šæ¸›: 268 â†’ 101 (-62%)
- Embeddingæ¤œè¨¼æ©Ÿèƒ½è¿½åŠ 

### v2.0.0 (2025-11-02) - ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°æœ€é©åŒ–ç‰ˆ
- ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼æ•°åˆ¶é™: k=2~5
- ãƒãƒ©ãƒ³ã‚¹æˆ¦ç•¥: 0.5:0.5
- Level 0ä¸€æ¬¡å‰Šæ¸›: 48% â†’ 41.6%

### v1.0.0 (2025-11-01) - åˆæœŸç‰ˆ
- PubMedçµ±åˆï¼ˆ3,182æ–‡æ›¸ï¼‰
- 7å±¤316ç”¨èªã®èªå½™ä½“ç³»
- Top-downã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°

---

## ğŸ¤ è²¢çŒ®

Issueã€Pull Requestã‚’æ­“è¿ã—ã¾ã™ã€‚

### é–‹ç™ºã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³
1. ç”Ÿç‰©å­¦çš„æ­£ç¢ºæ€§ã‚’æœ€å„ªå…ˆ
2. è‡¨åºŠç ”ç©¶ã§ã®ä½¿ç”¨å®Ÿç¸¾ã®ã‚ã‚‹ãƒãƒ¼ã‚«ãƒ¼ã‚’æ¡ç”¨
3. ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸80%ä»¥ä¸Šã‚’ç¶­æŒ

---

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT License

---

## ğŸ‘¥ ä½œè€…

AI Assistant with biological expertise collaboration

---

## ğŸ”— é–¢é€£ãƒªã‚½ãƒ¼ã‚¹

- [PubMed E-utilities](https://www.ncbi.nlm.nih.gov/books/NBK25501/)
- [RAPTOR Paper](https://arxiv.org/abs/2401.18059)
- [Sentence Transformers](https://www.sbert.net/)

---

**Last Updated**: 2025-11-02  
**Version**: 3.0.0  
**Status**: Production Ready âœ…
